.content-wrapper{style: "min-height: 1604.44px;"}
  %section.content-header
    .container-fluid
      .row.mb-2
        .col-sm-6
          %h1 Invoice Details
        .col-sm-6
          %ol.breadcrumb.float-sm-right
            = link_to 'Back to Invoices', company_invoices_path, class: 'btn btn-sm btn-primary'

  %section.content
    .container-fluid
      .row
        .col-12
          / Main content
          .invoice.p-3.mb-3
            / title row
            .row
              .col-12
                %h4
                  %i.fas.fa-globe
                  = current_company.name
                  %small.float-right Date: #{@invoice.date.strftime('%d/%m/%Y')}

            / info row
            .row.invoice-info
              .col-sm-4.invoice-col
                From
                %address
                  %strong= current_company.name
                  %br/
                  = current_company.address
                  - if current_company.phone.present?
                    %br/
                    Phone: #{current_company.phone}
                  - if current_company.email.present?
                    %br/
                    Email: #{current_company.email}

              .col-sm-4.invoice-col
                To
                %address
                  %strong= @invoice.customer.name
                  %br/
                  = @invoice.customer.address
                  - if @invoice.customer.phone.present?
                    %br/
                    Phone: #{@invoice.customer.phone}
                  - if @invoice.customer.email.present?
                    %br/
                    Email: #{@invoice.customer.email}

              .col-sm-4.invoice-col
                %b Invoice ##{@invoice.invoice_number}
                %br/
                %br/
                %b Invoice Date:
                = @invoice.date.strftime('%d/%m/%Y')
                %br/
                %b Due Date:
                = @invoice.due_date.strftime('%d/%m/%Y')
                %br/
                %b Status:
                %span.badge{class: "badge-#{@invoice.status == 'paid' ? 'success' : @invoice.status == 'pending' ? 'warning' : 'danger'}"}
                  = @invoice.status.titleize

            / Table row
            .row
              .col-12.table-responsive
                %table.table.table-striped
                  %thead
                    %tr
                      %th Qty
                      %th Product
                      %th Unit Price
                      %th Tax Rate
                      %th Tax Amount
                      %th Total
                  %tbody
                    - @invoice.invoice_products.each do |item|
                      %tr
                        %td= item.quantity
                        %td= item.product.name
                        %td= number_to_currency(item.unit_price)
                        %td
                          - if item.product.tax_rate.present?
                            = number_to_percentage(item.product.tax_rate, precision: 2)
                          - else
                            N/A
                        %td= number_to_currency(item.tax)
                        %td= number_to_currency(item.total)

            .row
              .col-6
                - if @invoice.note.present?
                  %p.lead Notes:
                  %p.text-muted.well.well-sm.shadow-none{style: "margin-top: 10px;"}
                    = @invoice.note

              .col-6
                %p.lead Amount Due #{@invoice.due_date.strftime('%d/%m/%Y')}
                .table-responsive
                  %table.table
                    %tbody
                      %tr
                        %th{style: "width:50%"} Subtotal:
                        %td= number_to_currency(@invoice.subtotal)
                      %tr
                        %th Total Tax:
                        %td= number_to_currency(@invoice.total_tax)
                      %tr
                        %th Grand Total:
                        %td
                          %strong= number_to_currency(@invoice.grand_total)

            .row.no-print
              .col-12
                %button.btn.btn-default{onclick: "window.print()"}
                  %i.fas.fa-print
                  Print
                = link_to company_invoice_path(@invoice, format: :pdf), class: 'btn btn-primary float-right', style: "margin-right: 5px;" do
                  %i.fas.fa-download
                  Generate PDF
                - if @invoice.status == 'pending'
                  = link_to mark_as_paid_company_invoice_path(@invoice), method: :patch, class: 'btn btn-success float-right', data: { confirm: 'Are you sure you want to mark this invoice as paid?' } do
                    %i.far.fa-credit-card
                    Mark as Paid